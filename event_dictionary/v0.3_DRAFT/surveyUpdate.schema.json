{
  "$id": "https://ons.gov.uk/surveyUpdate.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Survey Update",
  "type": "object",
  "properties": {
    "surveyUpdate": {
      "type": "object",
      "properties": {
        "surveyId": {
          "description": "The ID of the survey.",
          "type": "uuid",
          "examples": ["21ce842b-4359-402a-9311-973f07d2d253"]
        },
        "name": {
          "description": "The name of the survey.",
          "type": "string",
          "examples": ["LMS", "OPN", "RSI", "MBS", "Census", "CCS"]
        },
        "sampleColumns": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "columnName": {
                "description": "Title of a column in the sample file.",
                "type": "string",
                "examples": ["HOUSE_NAME", "BUSINESS_NAME", "UPRN"]
              },
              "metadata": {
                "description": "Extra information about this column.",
                "type": "object",
                "examples": [{ "commonName": "uprn" }]
              },
              "rules": {
                "description": "Rules governing this column.",
                "type": "object",
                "properties": {
                  "mandatory": {
                    "description": "True if the column is mandatory.",
                    "type": "boolean",
                    "examples": [true, false]
                  },
                  "type": {
                    "description": "Enforced/validated type of column data.",
                    "type": "string",
                    "enum": ["INTEGER", "FLOAT", "STRING"]
                  },
                  "sensitive": {
                    "description": "True if the column contains sensitive (PII) data.",
                    "type": "boolean",
                    "examples": [true, false]
                  },
                  "minLength": {
                    "description": "Minimum length of column data.",
                    "type": "integer",
                    "examples": [1, 5, 10]
                  },
                  "maxLength": {
                    "description": "Maximum length of column data.",
                    "type": "integer",
                    "examples": [1, 5, 10]
                  }
                },
                "required": ["mandatory", "type"]
              }
            },
            "required": ["columnName", "metadata", "rules"]
          }
        }
      },
      "required": ["surveyId", "name", "sampleColumns"],
      "additionalProperties": false
    }
  },
  "required": ["surveyUpdate"],
  "additionalProperties": false
}
